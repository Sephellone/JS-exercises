const TRANSITION_TIME=150,MAX_CARDS=26,shuffleArray=e=>{for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}},openCard=e=>{e.classList.add("rotated"),setTimeout((()=>{e.classList.add("open"),e.classList.remove("rotated")}),150)},closeCard=e=>{e.classList.add("rotated"),setTimeout((()=>{e.classList.remove("open"),e.classList.remove("rotated")}),150)},compareCards=(e,t)=>e.dataset.memory===t.dataset.memory,initMemoryGame=()=>{const e=document.querySelector('[data-memory="parent"]');if(!e)return;const t=e.querySelector('[data-memory="field"]'),a=e.querySelector('[data-memory="start"]'),s=e.querySelector('[data-memory="message"]');if(!t||!a||!s)return;let r;t.style.setProperty("--transition","150ms");let o,n,m,d=24,c=!1,l=0;const i={12:"easy",24:"normal",36:"hard",48:"insane"},y={easy:0,normal:0,hard:0,insane:0};let u;const h=()=>{s.querySelector('[data-memory="message-moves"]').textContent=l,s.querySelector('[data-memory="message-best-moves"]').textContent=y[m],s.classList.remove("hidden")},p=e=>{const t=e.target;var a;"field"!==t.dataset.memory&&t.dataset.memory&&!t.classList.contains("open")&&(o&&n||(l++,c?(openCard(t),n=t,a=n,o.dataset.memory===a.dataset.memory?(setTimeout((()=>{[o,n].forEach((e=>{e.classList.add("hidden")})),c=!1,o=null,n=null}),1050),u-=2,0===u&&((0===y[m]||l<y[m])&&(y[m]=l),setTimeout(h,1050))):setTimeout((()=>{[o,n].forEach((e=>{closeCard(e)})),c=!1,o=null,n=null}),1150)):(openCard(t),c=!0,o=t)))};a.addEventListener("click",(()=>{l=0,(()=>{const t=e.querySelector('[name="type"]:checked');r=t.value;const a=e.querySelector('[name="size"]:checked');d=parseInt(a.value),m=i[d]})(),(()=>{const e=[];for(;e.length<d;){const t=Math.floor(26*Math.random()+1);e.includes(t)||(e.push(t),e.push(t))}shuffleArray(e),t.innerHTML="",e.forEach((e=>{const a=document.createElement("div");a.classList.add("memory__card");const s=document.createElement("img");s.setAttribute("src",`img/memory/${r}s/${r}_${e}.webp`),a.append(s),a.setAttribute("data-memory",e),t.append(a)})),u=e.length})(),t.addEventListener("click",p)})),s.querySelector('[data-memory="message-button"]').addEventListener("click",(()=>{t.removeEventListener("click",p),s.classList.add("hidden")}))};export{initMemoryGame};